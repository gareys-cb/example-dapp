import{b as k,p as E,W as S,a as v,j as A,r as l,u as N,R as y,c as O}from"./vendor.9f2b267c.js";const I=function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))d(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&d(u)}).observe(document,{childList:!0,subtree:!0});function t(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerpolicy&&(o.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?o.credentials="include":e.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function d(e){if(e.ep)return;e.ep=!0;const o=t(e);fetch(e.href,o)}};I();window.Buffer=k.Buffer;window.process=E;var C="./assets/padlock.3a1fe527.png",x="./assets/padlock_open.c4541ffd.png";const W="Sesame",M="http://localhost:3000/src/padlock.png",P="https://mainnet.infura.io/v3/YOUR_INFURA_PROJECT_ID",_=1,R=()=>new S({appName:W,appLogoUrl:M,darkMode:!1}),U=s=>s.makeWeb3Provider(P,_),D=async s=>{var c,t,d,e,o,u;try{if(s==="walletlink"){let r;try{const i=(d=(t=(c=window.ethereum)==null?void 0:c.providers)==null?void 0:t.find(n=>!!n.isCoinbaseWallet))!=null?d:window.ethereum,p=R();r=U(p);const L=new v(r);return(!i||!i.isCoinbaseWallet)&&console.info("NO COINBASE WALLET FOUND - USING WALLETLINK SDK PROVIDER"),await r.enable(),{ethereum:r,web3:L}}catch(i){throw r.close(),i}}if(s==="metamask"){const r=(u=(o=(e=window.ethereum)==null?void 0:e.providers)==null?void 0:o.find(p=>!!p.isMetaMask))!=null?u:window.ethereum;if(!r||!r.isMetaMask||!window.ethereum)throw window.open("https://metamask.io/download.html","_blank"),new Error("NO METAMASK WALLET FOUND!");const i=new v(window.ethereum);return await r.request({method:"eth_requestAccounts"}),{ethereum:r,web3:i}}if(!window.ethereum)throw new Error("NO WALLET FOUND!");return{ethereum:window.ethereum,web3:new v(window.ethereum)}}catch(f){throw console.warn(f),new Error("Login failed!")}},a=A.exports.jsx,h=A.exports.jsxs,g="web3-provider";function T(){const[s,c]=l.exports.useState(),[t,d]=l.exports.useState(),[e,o]=l.exports.useState(),[u,f]=l.exports.useState(!0),r=!!s;l.exports.useEffect(()=>{const n=m=>{if(!m.length){p();return}const w=m[0];o(b=>(console.log("prevAccount: "+b,`
newAccount:  `+w),w))};return t==null||t.on("accountsChanged",n),()=>{t==null||t.removeListener("accountsChanged",n)}},[t]),l.exports.useEffect(()=>{const n=()=>{(t==null?void 0:t.isCoinbaseWallet)&&!localStorage.getItem("-walletlink:https://www.walletlink.org:version")&&localStorage.removeItem(g)};return addEventListener("beforeunload",n,{capture:!0}),()=>{removeEventListener("beforeunload",n)}}),l.exports.useEffect(()=>{const n=window.localStorage.getItem(g);n&&i(n).catch(p),f(!1)},[]);const i=l.exports.useCallback(async n=>{f(!0);try{const{ethereum:m,web3:w}=await D(n);localStorage.setItem(g,n),w==null||w.eth.getAccounts().then(b=>{o(b[0])}),d(m),c(w)}catch{console.warn("FAILED TO SIGN IN!")}finally{f(!1)}},[]),p=l.exports.useCallback(()=>{localStorage.removeItem(g),d(void 0),c(void 0),o(void 0),(t==null?void 0:t.isCoinbaseWallet)&&(t==null||t.close())},[t]),L=l.exports.useCallback(async()=>{try{if(!e)throw new Error("NO ACCOUNT AVAILABLE");const n=await(s==null?void 0:s.eth.personal.sign("Open Sesame!",e,""));console.info(n)}catch(n){console.warn(n)}},[s,e]);return h("div",{className:"App",children:[a("h1",{children:"Sesame"}),a("img",{src:r?x:C,className:"App-logo",alt:"logo"}),u?a("p",{children:"loading..."}):h("div",{children:[!r&&h("div",{className:"content",children:[a("p",{children:"Sign in with your wallet"}),a("button",{type:"button",onClick:()=>i("walletlink"),children:"Coinbase Wallet"}),a("button",{type:"button",onClick:()=>i("metamask"),children:"MetaMask Wallet"})]}),r&&h("div",{className:"content",children:[a("p",{children:"Open Sesame!"}),h("small",{children:["Signed into account: ",e]}),a("button",{type:"button",onClick:L,children:"Sign Message"}),a("button",{className:"signout",type:"button",onClick:p,children:"Sign out"})]})]})]})}window.util=N;y.render(a(O.StrictMode,{children:a(T,{})}),document.getElementById("root"));
