import{b as I,p as N,u as E,W as S,a as m,c as A,r as l,j as b,R as k,d as y}from"./vendor.5dfdda24.js";const O=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&c(s)}).observe(document,{childList:!0,subtree:!0});function e(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function c(n){if(n.ep)return;n.ep=!0;const o=e(n);fetch(n.href,o)}};O();window.Buffer=I.Buffer;window.process=N;window.util=E;var x="./assets/padlock.3a1fe527.png",W="./assets/padlock_open.c4541ffd.png";const v="YOUR_INFURA_PROJECT_ID",_="Sesame",M="https://gareys-cb.github.io/sesame/assets/padlock.png",R=`https://mainnet.infura.io/v3/${v}`,P=1,U=t=>t.makeWeb3Provider(R,P),D=async()=>{var o,s,u;const t=(u=(s=(o=window.ethereum)==null?void 0:o.providers)==null?void 0:s.find(f=>!!f.isCoinbaseWallet))!=null?u:window.ethereum,r=new S({appName:_,appLogoUrl:M,darkMode:!1}),e=U(r),c=new m(e);(!t||!t.isCoinbaseWallet)&&console.info("NO COINBASE WALLET FOUND - USING WALLETLINK SDK PROVIDER");const n=await e.enable();return{provider:e,web3:c,accounts:n}},T=async()=>{var c,n,o;const t=(o=(n=(c=window.ethereum)==null?void 0:c.providers)==null?void 0:n.find(s=>!!s.isMetaMask))!=null?o:window.ethereum;if(!t||!t.isMetaMask||!window.ethereum)throw window.open("https://metamask.io/download.html","_blank"),new Error("NO METAMASK WALLET FOUND!");const r=new m(window.ethereum),e=await t.request({method:"eth_requestAccounts"});return{provider:t,web3:r,accounts:e}},F="YOUR_INFURA_PROJECT_ID",B=async()=>new Promise(async(t,r)=>{const e=new A({infuraId:F}),c=new m(e);let n=!0;const o=()=>n,s=()=>{!o()||(console.log("WALLET CONNECT DISCONNECTED"),r())};e.connector.on("disconnect",s);try{const u=await e.enable();n=!1,t({provider:e,web3:c,accounts:u})}catch{r()}}),j=async t=>{switch(t){case"walletlink":return D();case"metamask":return T();case"walletconnect":return B();default:if(!window.ethereum)throw new Error("NO WALLET FOUND!");return{provider:window.ethereum,web3:new m(window.ethereum),accounts:[]}}},g="web3-provider",h=window.localStorage.getItem(g),K=()=>{const[t,r]=l.exports.useState(),[e,c]=l.exports.useState(),[n,o]=l.exports.useState(),s=l.exports.useCallback(()=>{if(localStorage.removeItem(g),c(void 0),r(void 0),o(void 0),e==null?void 0:e.isCoinbaseWallet){e==null||e.close();return}(e==null?void 0:e.isWalletConnect)&&(e==null||e.disconnect())},[e]),u=l.exports.useCallback(async a=>{try{const{provider:d,web3:L,accounts:C}=await j(a);localStorage.setItem(g,a),c(d),r(L),o(C[0])}catch{console.warn("FAILED TO SIGN IN!"),s()}},[s]),f=l.exports.useCallback(async()=>{try{if(!n||!t)throw new Error("NO ACCOUNT AVAILABLE");const a=await t.eth.personal.sign("Open Sesame!",n,"");console.info(a)}catch(a){console.warn(a)}},[t,n]);return l.exports.useEffect(()=>{const a=d=>{if(!d.length){s();return}o(d[0])};return e==null||e.on("accountsChanged",a),()=>{e==null||e.removeListener("accountsChanged",a)}},[e,s]),l.exports.useEffect(()=>{if(!(e==null?void 0:e.isWalletConnect))return;const a=()=>{s()};return e==null||e.on("disconnect",a),()=>{e==null||e.removeListener("disconnect",a)}},[e,s]),l.exports.useEffect(()=>{if(!(e==null?void 0:e.isCoinbaseWallet))return;const a=()=>{localStorage.getItem("-walletlink:https://www.walletlink.org:version")||localStorage.removeItem(g)};return addEventListener("beforeunload",a,{capture:!0}),()=>{removeEventListener("beforeunload",a)}},[e]),l.exports.useEffect(()=>{h&&u(h).catch(s)},[]),{login:u,logout:s,account:n,web3:t,signMessage:f}},i=b.exports.jsx,w=b.exports.jsxs,p=({providerString:t,handleLogin:r,text:e})=>i("button",{type:"button",onClick:()=>r(t),children:e}),q=l.exports.memo(({handleLogin:t})=>w("div",{className:"content",children:[i("p",{children:"Sign in with your wallet"}),i(p,{providerString:"walletlink",handleLogin:t,text:"Coinbase Wallet"}),i(p,{providerString:"metamask",handleLogin:t,text:"MetaMask"}),i(p,{providerString:"walletconnect",handleLogin:t,text:"WalletConnect"})]})),G=l.exports.memo(({account:t,handleSignMessage:r,handleLogout:e})=>w("div",{className:"content",children:[i("p",{children:"Open Sesame!"}),w("small",{children:["Signed into account: ",t]}),i("button",{type:"button",onClick:r,children:"Sign Message"}),i("button",{className:"signout",type:"button",onClick:e,children:"Sign out"})]}));function J(){const{login:t,logout:r,account:e,web3:c,signMessage:n}=K(),[o,s]=l.exports.useState(!!h),u=!!c;l.exports.useEffect(()=>{c&&o&&s(!1)},[c,o]);const f=l.exports.useCallback(async d=>{s(!0),await t(d).finally(()=>{s(!1)})},[t]),a=l.exports.useCallback(()=>{s(!0),r(),s(!1)},[r]);return w("div",{className:"App",children:[i("h1",{children:"Sesame"}),i("img",{src:u?W:x,className:"App-logo",alt:"logo"}),o?i("p",{children:"loading..."}):w("div",{children:[!u&&i(q,{handleLogin:f}),u&&i(G,{handleLogout:a,handleSignMessage:n,account:e})]})]})}k.render(i(y.StrictMode,{children:i(J,{})}),document.getElementById("root"));
