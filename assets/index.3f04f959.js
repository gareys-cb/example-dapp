import{b as S,p as E,W as y,a as b,j as k,r as a,u as N,R as O,c as C}from"./vendor.9f2b267c.js";const I=function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const u of n.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&c(u)}).observe(document,{childList:!0,subtree:!0});function e(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerpolicy&&(n.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?n.credentials="include":t.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function c(t){if(t.ep)return;t.ep=!0;const n=e(t);fetch(t.href,n)}};I();window.Buffer=S.Buffer;window.process=E;var x="./assets/padlock.3a1fe527.png",M="./assets/padlock_open.c4541ffd.png";const W="Sesame",P="http://localhost:3000/src/padlock.png",_="https://mainnet.infura.io/v3/YOUR_INFURA_PROJECT_ID",R=1,U=()=>new y({appName:W,appLogoUrl:P,darkMode:!1}),D=s=>s.makeWeb3Provider(_,R),v=async s=>{var l,e,c,t,n,u;try{if(s==="walletlink"){let r;try{const d=(c=(e=(l=window.ethereum)==null?void 0:l.providers)==null?void 0:e.find(o=>!!o.isCoinbaseWallet))!=null?c:window.ethereum,p=U();r=D(p);const L=new b(r);return(!d||!d.isCoinbaseWallet)&&console.info("NO COINBASE WALLET FOUND - USING WALLETLINK SDK PROVIDER"),await r.enable(),{ethereum:r,web3:L}}catch(d){throw r.close(),d}}if(s==="metamask"){const r=(u=(n=(t=window.ethereum)==null?void 0:t.providers)==null?void 0:n.find(p=>!!p.isMetaMask))!=null?u:window.ethereum;if(!r||!r.isMetaMask||!window.ethereum)throw window.open("https://metamask.io/download.html","_blank"),new Error("NO METAMASK WALLET FOUND!");const d=new b(window.ethereum);return await r.request({method:"eth_requestAccounts"}),{ethereum:r,web3:d}}if(!window.ethereum)throw new Error("NO WALLET FOUND!");return{ethereum:window.ethereum,web3:new b(window.ethereum)}}catch(f){throw console.warn(f),new Error("Login failed!")}},i=k.exports.jsx,g=k.exports.jsxs,m="web3-provider";function T(){const[s,l]=a.exports.useState(),[e,c]=a.exports.useState(),[t,n]=a.exports.useState(),[u,f]=a.exports.useState(!0),r=!!s;a.exports.useEffect(()=>{const o=w=>{if(!w.length){p();return}const h=w[0];n(A=>(console.log("prevAccount: "+A,`
newAccount:  `+h),h))};return e==null||e.on("accountsChanged",o),()=>{e==null||e.removeListener("accountsChanged",o)}},[e]),a.exports.useEffect(()=>{const o=()=>{(e==null?void 0:e.isCoinbaseWallet)&&!localStorage.getItem("-walletlink:https://www.walletlink.org:version")&&localStorage.removeItem(m)};return addEventListener("beforeunload",o,{capture:!0}),e==null||e.on("disconnect",o),()=>{removeEventListener("beforeunload",o),e==null||e.removeListener("disconnect",o)}}),a.exports.useEffect(()=>{const o=window.localStorage.getItem(m);o&&v(o).then(({ethereum:w,web3:h})=>{c(w),l(h)}).catch(p),f(!1)},[]),a.exports.useEffect(()=>{(e==null?void 0:e.isCoinbaseWallet)&&localStorage.setItem(m,"walletlink"),(e==null?void 0:e.isMetaMask)&&localStorage.setItem(m,"metamask"),s==null||s.eth.getAccounts().then(o=>{n(o[0])})},[s,e]);const d=a.exports.useCallback(async o=>{f(!0);try{const{ethereum:w,web3:h}=await v(o);c(w),l(h)}catch{console.warn("FAILED TO SIGN IN!")}finally{f(!1)}},[]),p=a.exports.useCallback(()=>{localStorage.removeItem(m),c(void 0),l(void 0),(e==null?void 0:e.isCoinbaseWallet)&&(e==null||e.close())},[e]),L=a.exports.useCallback(async()=>{try{if(!t)throw new Error("NO ACCOUNT AVAILABLE");const o=await(s==null?void 0:s.eth.personal.sign("Open Sesame!",t,""));console.info(o)}catch(o){console.warn(o)}},[s,t]);return i("div",{className:"App",children:g("header",{className:"App-header",children:[i("p",{children:"Sesame"}),i("img",{src:r?M:x,className:"App-logo",alt:"logo"}),u?i("p",{children:"loading..."}):g("div",{children:[!r&&g("div",{children:[g("p",{style:{display:"flex",justifyContent:"space-around"},children:[i("button",{type:"button",onClick:()=>d("walletlink"),children:"Sign in with CB"}),i("button",{type:"button",onClick:()=>d("metamask"),children:"Sign in with MM"})]}),i("p",{children:"Sign in to access your generative password store"})]}),r&&g("div",{children:[i("p",{children:i("button",{type:"button",onClick:p,children:"Sign out"})}),i("p",{children:"Open Sesame! You're logged in"}),i("h6",{children:t})]}),i("button",{type:"button",onClick:L,children:"Sign Message"})]})]})})}window.util=N;O.render(i(C.StrictMode,{children:i(T,{})}),document.getElementById("root"));
