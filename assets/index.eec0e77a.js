import{b as k,p as N,u as A,W as S,a as f,C as O,c as h,E as x,d as W,r as l,j as b,R as _,e as M}from"./vendor.213a0180.js";const v=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function e(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerpolicy&&(o.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?o.credentials="include":t.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(t){if(t.ep)return;t.ep=!0;const o=e(t);fetch(t.href,o)}};v();window.Buffer=k.Buffer;window.process=N;window.util=A;var P="./assets/padlock.3a1fe527.png",R="./assets/padlock_open.c4541ffd.png";const L="YOUR_INFURA_PROJECT_ID",T="468669423ad110ab1af59274e8ab5c95",C="Sesame",E="http://localhost:3000/src/assets/padlock.png",U=`https://mainnet.infura.io/v3/${L}`,D=1,F=n=>n.makeWeb3Provider(U,D),j=async()=>{var o,s,u;const n=(u=(s=(o=window.ethereum)==null?void 0:o.providers)==null?void 0:s.find(d=>!!d.isCoinbaseWallet))!=null?u:window.ethereum,a=new S({appName:C,appLogoUrl:E,darkMode:!1}),e=F(a),r=new f(e);(!n||!n.isCoinbaseWallet)&&console.info("NO COINBASE WALLET FOUND - USING WALLETLINK SDK PROVIDER");const t=await e.enable();return{provider:e,web3:r,accounts:t}},B=async()=>{var r,t,o;const n=(o=(t=(r=window.ethereum)==null?void 0:r.providers)==null?void 0:t.find(s=>!!s.isMetaMask))!=null?o:window.ethereum;if(!n||!n.isMetaMask||!window.ethereum)throw window.open("https://metamask.io/download.html","_blank"),new Error("NO METAMASK WALLET FOUND!");const a=new f(window.ethereum),e=await n.request({method:"eth_requestAccounts"});return{provider:n,web3:a,accounts:e}},K=async()=>new Promise(async(n,a)=>{const e=await O.init({projectId:T,relayUrl:"wss://relay.walletconnect.com",metadata:{name:C,description:"Example Dapp",url:"http://localhost:3000/",icons:[E]}}),r=async u=>{const{uri:d}=u.signal.params;W.open(d,()=>{a()})};e.on(h.pairing.proposal,r);const t=new x({chainId:1,client:e,rpc:{infuraId:L}}),o=new f(t),s=await t.enable().finally(()=>{e.removeListener(h.pairing.proposal,r)});n({provider:t,web3:o,accounts:s})}),q=async n=>{switch(n){case"walletlink":return j();case"metamask":return B();case"walletconnect":return K();default:if(!window.ethereum)throw new Error("NO WALLET FOUND!");return{provider:window.ethereum,web3:new f(window.ethereum),accounts:[]}}},m="web3-provider",g=window.localStorage.getItem(m),G=()=>{const[n,a]=l.exports.useState(),[e,r]=l.exports.useState(),[t,o]=l.exports.useState(),s=l.exports.useCallback(()=>{if(localStorage.removeItem(m),r(void 0),a(void 0),o(void 0),e==null?void 0:e.isCoinbaseWallet){e==null||e.close();return}(e==null?void 0:e.isWalletConnect)&&(e==null||e.disconnect())},[e]),u=l.exports.useCallback(async c=>{try{const{provider:w,web3:y,accounts:I}=await q(c);localStorage.setItem(m,c),r(w),a(y),o(I[0])}catch{console.warn("FAILED TO SIGN IN!"),s()}},[s]),d=l.exports.useCallback(async()=>{try{if(!t||!n)throw new Error("NO ACCOUNT AVAILABLE");const c=await n.eth.personal.sign("Open Sesame!",t,"");console.info(c)}catch(c){console.warn(c)}},[n,t]);return l.exports.useEffect(()=>{const c=w=>{if(!w.length){s();return}o(w[0])};return e==null||e.on("accountsChanged",c),()=>{e==null||e.removeListener("accountsChanged",c)}},[e,s]),l.exports.useEffect(()=>{if(!(e==null?void 0:e.isWalletConnect))return;const c=()=>{s()};return e==null||e.on("disconnect",c),()=>{e==null||e.removeListener("disconnect",c)}},[e,s]),l.exports.useEffect(()=>{if(!(e==null?void 0:e.isCoinbaseWallet))return;const c=()=>{localStorage.getItem("-walletlink:https://www.walletlink.org:version")||localStorage.removeItem(m)};return addEventListener("beforeunload",c,{capture:!0}),()=>{removeEventListener("beforeunload",c)}},[e]),l.exports.useEffect(()=>{g&&u(g).catch(s)},[]),{login:u,logout:s,account:t,web3:n,signMessage:d}},i=b.exports.jsx,p=b.exports.jsxs,J=l.exports.memo(({handleLogin:n})=>p("div",{className:"content",children:[i("p",{children:"Sign in with your wallet"}),i("button",{type:"button",onClick:()=>n("walletlink"),children:"Coinbase Wallet"}),i("button",{type:"button",onClick:()=>n("metamask"),children:"MetaMask"}),i("button",{type:"button",onClick:()=>n("walletconnect"),children:"WalletConnect"})]})),V=l.exports.memo(({account:n,handleSignMessage:a,handleLogout:e})=>p("div",{className:"content",children:[i("p",{children:"Open Sesame!"}),p("small",{children:["Signed into account: ",n]}),i("button",{type:"button",onClick:a,children:"Sign Message"}),i("button",{className:"signout",type:"button",onClick:e,children:"Sign out"})]}));function Y(){const{login:n,logout:a,account:e,web3:r,signMessage:t}=G(),[o,s]=l.exports.useState(!!g),u=!!r,d=l.exports.useCallback(async w=>{s(!0),await n(w).finally(()=>{s(!1)})},[n]),c=l.exports.useCallback(()=>{s(!0),a(),s(!1)},[a]);return p("div",{className:"App",children:[i("h1",{children:"Sesame"}),i("img",{src:u?R:P,className:"App-logo",alt:"logo"}),o?i("p",{children:"loading..."}):p("div",{children:[!u&&i(J,{handleLogin:d}),u&&i(V,{handleLogout:c,handleSignMessage:t,account:e})]})]})}_.render(i(M.StrictMode,{children:i(Y,{})}),document.getElementById("root"));
