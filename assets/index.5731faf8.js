import{W as S,a as b,j as k,r as a,u as y,R as E,b as N}from"./vendor.532a0028.js";const C=function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const u of n.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&c(u)}).observe(document,{childList:!0,subtree:!0});function e(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerpolicy&&(n.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?n.credentials="include":t.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function c(t){if(t.ep)return;t.ep=!0;const n=e(t);fetch(t.href,n)}};C();var O="./assets/padlock.3a1fe527.png",x="./assets/padlock_open.c4541ffd.png";const I="Sesame",M="http://localhost:3000/src/padlock.png",W="https://mainnet.infura.io/v3/56184607230a477bbe2cb7687f8a7786",P=1,_=()=>new S({appName:I,appLogoUrl:M,darkMode:!1}),D=r=>r.makeWeb3Provider(W,P),v=async r=>{var l,e,c,t,n,u;try{if(r==="walletlink"){let s;try{const d=(c=(e=(l=window.ethereum)==null?void 0:l.providers)==null?void 0:e.find(o=>!!o.isCoinbaseWallet))!=null?c:window.ethereum,p=_();s=D(p);const L=new b(s);return(!d||!d.isCoinbaseWallet)&&console.info("NO COINBASE WALLET FOUND - USING WALLETLINK SDK PROVIDER"),await s.enable(),{ethereum:s,web3:L}}catch(d){throw s.close(),d}}if(r==="metamask"){const s=(u=(n=(t=window.ethereum)==null?void 0:t.providers)==null?void 0:n.find(p=>!!p.isMetaMask))!=null?u:window.ethereum;if(!s||!s.isMetaMask||!window.ethereum)throw window.open("https://metamask.io/download.html","_blank"),new Error("NO METAMASK WALLET FOUND!");const d=new b(window.ethereum);return await s.request({method:"eth_requestAccounts"}),{ethereum:s,web3:d}}if(!window.ethereum)throw new Error("NO WALLET FOUND!");return{ethereum:window.ethereum,web3:new b(window.ethereum)}}catch(f){throw console.warn(f),new Error("Login failed!")}},i=k.exports.jsx,g=k.exports.jsxs,m="web3-provider";function T(){const[r,l]=a.exports.useState(),[e,c]=a.exports.useState(),[t,n]=a.exports.useState(),[u,f]=a.exports.useState(!0),s=!!r;a.exports.useEffect(()=>{const o=w=>{if(!w.length){p();return}const h=w[0];n(A=>(console.log("prevAccount: "+A,`
newAccount:  `+h),h))};return e==null||e.on("accountsChanged",o),()=>{e==null||e.removeListener("accountsChanged",o)}},[e]),a.exports.useEffect(()=>{const o=()=>{(e==null?void 0:e.isCoinbaseWallet)&&!localStorage.getItem("-walletlink:https://www.walletlink.org:version")&&localStorage.removeItem(m)};return addEventListener("beforeunload",o,{capture:!0}),e==null||e.on("disconnect",o),()=>{removeEventListener("beforeunload",o),e==null||e.removeListener("disconnect",o)}}),a.exports.useEffect(()=>{const o=window.localStorage.getItem(m);o&&v(o).then(({ethereum:w,web3:h})=>{c(w),l(h)}).catch(p),f(!1)},[]),a.exports.useEffect(()=>{(e==null?void 0:e.isCoinbaseWallet)&&localStorage.setItem(m,"walletlink"),(e==null?void 0:e.isMetaMask)&&localStorage.setItem(m,"metamask"),r==null||r.eth.getAccounts().then(o=>{n(o[0])})},[r,e]);const d=a.exports.useCallback(async o=>{f(!0);try{const{ethereum:w,web3:h}=await v(o);c(w),l(h)}catch{console.warn("FAILED TO SIGN IN!")}finally{f(!1)}},[]),p=a.exports.useCallback(()=>{localStorage.removeItem(m),c(void 0),l(void 0),(e==null?void 0:e.isCoinbaseWallet)&&(e==null||e.close())},[e]),L=a.exports.useCallback(async()=>{try{if(!t)throw new Error("NO ACCOUNT AVAILABLE");const o=await(r==null?void 0:r.eth.personal.sign("Open Sesame!",t,""));console.info(o)}catch(o){console.warn(o)}},[r,t]);return i("div",{className:"App",children:g("header",{className:"App-header",children:[i("p",{children:"Sesame"}),i("img",{src:s?x:O,className:"App-logo",alt:"logo"}),u?i("p",{children:"loading..."}):g("div",{children:[!s&&g("div",{children:[g("p",{style:{display:"flex",justifyContent:"space-around"},children:[i("button",{type:"button",onClick:()=>d("walletlink"),children:"Sign in with CB"}),i("button",{type:"button",onClick:()=>d("metamask"),children:"Sign in with MM"})]}),i("p",{children:"Sign in to access your generative password store"})]}),s&&g("div",{children:[i("p",{children:i("button",{type:"button",onClick:p,children:"Sign out"})}),i("p",{children:"Open Sesame! You're logged in"}),i("h6",{children:t})]}),i("button",{type:"button",onClick:L,children:"Sign Message"})]})]})})}window.util=y;E.render(i(N.StrictMode,{children:i(T,{})}),document.getElementById("root"));
