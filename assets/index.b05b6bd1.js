import{b as k,p as N,u as A,W as S,a as g,C as O,c as h,E as x,d as W,r as i,j as b,R as _,e as M}from"./vendor.213a0180.js";const v=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&c(s)}).observe(document,{childList:!0,subtree:!0});function e(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerpolicy&&(o.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?o.credentials="include":t.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function c(t){if(t.ep)return;t.ep=!0;const o=e(t);fetch(t.href,o)}};v();window.Buffer=k.Buffer;window.process=N;window.util=A;var P="./assets/padlock.3a1fe527.png",R="./assets/padlock_open.c4541ffd.png";const L="YOUR_INFURA_PROJECT_ID",T="468669423ad110ab1af59274e8ab5c95",C="Sesame",y="https://gareys-cb.github.io/sesame/assets/padlock.png",U=`https://mainnet.infura.io/v3/${L}`,D=1,F=n=>n.makeWeb3Provider(U,D),j=async()=>{var o,s,u;const n=(u=(s=(o=window.ethereum)==null?void 0:o.providers)==null?void 0:s.find(d=>!!d.isCoinbaseWallet))!=null?u:window.ethereum,a=new S({appName:C,appLogoUrl:y,darkMode:!1}),e=F(a),c=new g(e);(!n||!n.isCoinbaseWallet)&&console.info("NO COINBASE WALLET FOUND - USING WALLETLINK SDK PROVIDER");const t=await e.enable();return{provider:e,web3:c,accounts:t}},B=async()=>{var c,t,o;const n=(o=(t=(c=window.ethereum)==null?void 0:c.providers)==null?void 0:t.find(s=>!!s.isMetaMask))!=null?o:window.ethereum;if(!n||!n.isMetaMask||!window.ethereum)throw window.open("https://metamask.io/download.html","_blank"),new Error("NO METAMASK WALLET FOUND!");const a=new g(window.ethereum),e=await n.request({method:"eth_requestAccounts"});return{provider:n,web3:a,accounts:e}},K=async()=>new Promise(async(n,a)=>{const e=await O.init({projectId:T,relayUrl:"wss://relay.walletconnect.com",metadata:{name:C,description:"Example Dapp",url:"https://gareys-cb.github.io/sesame/",icons:[y]}}),c=async u=>{const{uri:d}=u.signal.params;W.open(d,()=>{a()})};e.on(h.pairing.proposal,c);const t=new x({chainId:1,client:e,rpc:{infuraId:L}}),o=new g(t),s=await t.enable().finally(()=>{e.removeListener(h.pairing.proposal,c)});n({provider:t,web3:o,accounts:s})}),q=async n=>{switch(n){case"walletlink":return j();case"metamask":return B();case"walletconnect":return K();default:if(!window.ethereum)throw new Error("NO WALLET FOUND!");return{provider:window.ethereum,web3:new g(window.ethereum),accounts:[]}}},m="web3-provider",f=window.localStorage.getItem(m),G=()=>{const[n,a]=i.exports.useState(),[e,c]=i.exports.useState(),[t,o]=i.exports.useState(),s=i.exports.useCallback(()=>{if(localStorage.removeItem(m),c(void 0),a(void 0),o(void 0),e==null?void 0:e.isCoinbaseWallet){e==null||e.close();return}(e==null?void 0:e.isWalletConnect)&&(e==null||e.disconnect())},[e]),u=i.exports.useCallback(async r=>{try{const{provider:w,web3:E,accounts:I}=await q(r);localStorage.setItem(m,r),c(w),a(E),o(I[0])}catch{console.warn("FAILED TO SIGN IN!"),s()}},[s]),d=i.exports.useCallback(async()=>{try{if(!t||!n)throw new Error("NO ACCOUNT AVAILABLE");const r=await n.eth.personal.sign("Open Sesame!",t,"");console.info(r)}catch(r){console.warn(r)}},[n,t]);return i.exports.useEffect(()=>{const r=w=>{if(!w.length){s();return}o(w[0])};return e==null||e.on("accountsChanged",r),()=>{e==null||e.removeListener("accountsChanged",r)}},[e,s]),i.exports.useEffect(()=>{if(!(e==null?void 0:e.isWalletConnect))return;const r=()=>{s()};return e==null||e.on("disconnect",r),()=>{e==null||e.removeListener("disconnect",r)}},[e,s]),i.exports.useEffect(()=>{if(!(e==null?void 0:e.isCoinbaseWallet))return;const r=()=>{localStorage.getItem("-walletlink:https://www.walletlink.org:version")||localStorage.removeItem(m)};return addEventListener("beforeunload",r,{capture:!0}),()=>{removeEventListener("beforeunload",r)}},[e]),i.exports.useEffect(()=>{f&&u(f).catch(s)},[]),{login:u,logout:s,account:t,web3:n,signMessage:d}},l=b.exports.jsx,p=b.exports.jsxs,J=i.exports.memo(({handleLogin:n})=>p("div",{className:"content",children:[l("p",{children:"Sign in with your wallet"}),l("button",{type:"button",onClick:()=>n("walletlink"),children:"Coinbase Wallet"}),l("button",{type:"button",onClick:()=>n("metamask"),children:"MetaMask"}),l("button",{type:"button",onClick:()=>n("walletconnect"),children:"WalletConnect"})]})),V=i.exports.memo(({account:n,handleSignMessage:a,handleLogout:e})=>p("div",{className:"content",children:[l("p",{children:"Open Sesame!"}),p("small",{children:["Signed into account: ",n]}),l("button",{type:"button",onClick:a,children:"Sign Message"}),l("button",{className:"signout",type:"button",onClick:e,children:"Sign out"})]}));function Y(){const{login:n,logout:a,account:e,web3:c,signMessage:t}=G(),[o,s]=i.exports.useState(!!f),u=!!c,d=i.exports.useCallback(async w=>{s(!0),await n(w).finally(()=>{s(!1)})},[n]),r=i.exports.useCallback(()=>{s(!0),a(),s(!1)},[a]);return p("div",{className:"App",children:[l("h1",{children:"Sesame"}),l("img",{src:u?R:P,className:"App-logo",alt:"logo"}),o?l("p",{children:"loading..."}):p("div",{children:[!u&&l(J,{handleLogin:d}),u&&l(V,{handleLogout:r,handleSignMessage:t,account:e})]})]})}_.render(l(M.StrictMode,{children:l(Y,{})}),document.getElementById("root"));
