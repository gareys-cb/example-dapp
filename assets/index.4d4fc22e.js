import{b as E,p as N,W as S,a as L,j as k,r as i,u as y,R as O,c as I}from"./vendor.9f2b267c.js";const C=function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const u of n.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&c(u)}).observe(document,{childList:!0,subtree:!0});function e(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerpolicy&&(n.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?n.credentials="include":t.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function c(t){if(t.ep)return;t.ep=!0;const n=e(t);fetch(t.href,n)}};C();window.Buffer=E.Buffer;window.process=N;var x="./assets/padlock.3a1fe527.png",W="./assets/padlock_open.c4541ffd.png";const M="Sesame",P="http://localhost:3000/src/padlock.png",_="https://mainnet.infura.io/v3/YOUR_INFURA_PROJECT_ID",R=1,U=()=>new S({appName:M,appLogoUrl:P,darkMode:!1}),D=s=>s.makeWeb3Provider(_,R),v=async s=>{var l,e,c,t,n,u;try{if(s==="walletlink"){let r;try{const d=(c=(e=(l=window.ethereum)==null?void 0:l.providers)==null?void 0:e.find(o=>!!o.isCoinbaseWallet))!=null?c:window.ethereum,p=U();r=D(p);const b=new L(r);return(!d||!d.isCoinbaseWallet)&&console.info("NO COINBASE WALLET FOUND - USING WALLETLINK SDK PROVIDER"),await r.enable(),{ethereum:r,web3:b}}catch(d){throw r.close(),d}}if(s==="metamask"){const r=(u=(n=(t=window.ethereum)==null?void 0:t.providers)==null?void 0:n.find(p=>!!p.isMetaMask))!=null?u:window.ethereum;if(!r||!r.isMetaMask||!window.ethereum)throw window.open("https://metamask.io/download.html","_blank"),new Error("NO METAMASK WALLET FOUND!");const d=new L(window.ethereum);return await r.request({method:"eth_requestAccounts"}),{ethereum:r,web3:d}}if(!window.ethereum)throw new Error("NO WALLET FOUND!");return{ethereum:window.ethereum,web3:new L(window.ethereum)}}catch(f){throw console.warn(f),new Error("Login failed!")}},a=k.exports.jsx,g=k.exports.jsxs,h="web3-provider";function T(){const[s,l]=i.exports.useState(),[e,c]=i.exports.useState(),[t,n]=i.exports.useState(),[u,f]=i.exports.useState(!0),r=!!s;i.exports.useEffect(()=>{const o=w=>{if(!w.length){p();return}const m=w[0];n(A=>(console.log("prevAccount: "+A,`
newAccount:  `+m),m))};return e==null||e.on("accountsChanged",o),()=>{e==null||e.removeListener("accountsChanged",o)}},[e]),i.exports.useEffect(()=>{const o=()=>{(e==null?void 0:e.isCoinbaseWallet)&&!localStorage.getItem("-walletlink:https://www.walletlink.org:version")&&localStorage.removeItem(h)};return addEventListener("beforeunload",o,{capture:!0}),e==null||e.on("disconnect",o),()=>{removeEventListener("beforeunload",o),e==null||e.removeListener("disconnect",o)}}),i.exports.useEffect(()=>{const o=window.localStorage.getItem(h);o&&v(o).then(({ethereum:w,web3:m})=>{c(w),l(m)}).catch(p),f(!1)},[]),i.exports.useEffect(()=>{(e==null?void 0:e.isCoinbaseWallet)&&localStorage.setItem(h,"walletlink"),(e==null?void 0:e.isMetaMask)&&localStorage.setItem(h,"metamask"),s==null||s.eth.getAccounts().then(o=>{n(o[0])})},[s,e]);const d=i.exports.useCallback(async o=>{f(!0);try{const{ethereum:w,web3:m}=await v(o);c(w),l(m)}catch{console.warn("FAILED TO SIGN IN!")}finally{f(!1)}},[]),p=i.exports.useCallback(()=>{localStorage.removeItem(h),c(void 0),l(void 0),(e==null?void 0:e.isCoinbaseWallet)&&(e==null||e.close())},[e]),b=i.exports.useCallback(async()=>{try{if(!t)throw new Error("NO ACCOUNT AVAILABLE");const o=await(s==null?void 0:s.eth.personal.sign("Open Sesame!",t,""));console.info(o)}catch(o){console.warn(o)}},[s,t]);return g("div",{className:"App",children:[a("h1",{children:"Sesame"}),a("img",{src:r?W:x,className:"App-logo",alt:"logo"}),u?a("p",{children:"loading..."}):g("div",{children:[!r&&a("div",{className:"content",children:g("div",{className:"vertical-button-group",children:[a("p",{children:"Sign in with your wallet"}),a("button",{type:"button",onClick:()=>d("walletlink"),children:"Coinbase Wallet"}),a("button",{type:"button",onClick:()=>d("metamask"),children:"MetaMask Wallet"})]})}),r&&g("div",{className:"content",children:[a("p",{children:"Open Sesame!"}),g("div",{className:"vertical-button-group",children:[g("small",{children:["Signed into account: ",t]}),a("button",{type:"button",onClick:b,children:"Sign Message"}),a("button",{className:"signout",type:"button",onClick:p,children:"Sign out"})]})]})]})]})}window.util=y;O.render(a(I.StrictMode,{children:a(T,{})}),document.getElementById("root"));
