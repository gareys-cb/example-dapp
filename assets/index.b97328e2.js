import{b as C,p as k,u as y,W as L,a as w,c as x,r as c,j as g,R as A,d as I}from"./vendor.5dfdda24.js";const N=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function e(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=e(n);fetch(n.href,o)}};N();window.Buffer=C.Buffer;window.process=k;window.util=y;var S="./assets/padlock.3a1fe527.png",E="./assets/padlock_open.c4541ffd.png";const P="YOUR_INFURA_PROJECT_ID",O="Sesame",_="https://gareys-cb.github.io/sesame/assets/padlock.png",M=`https://mainnet.infura.io/v3/${P}`,W=1,R=t=>t.makeWeb3Provider(M,W),U=async()=>{const t=new L({appName:O,appLogoUrl:_,darkMode:!1,overrideIsMetaMask:!1}),s=R(t),e=new w(s),a=await s.enable();return{provider:s,web3:e,accounts:a}},D=async()=>{var a,n,o;const t=(o=(n=(a=window.ethereum)==null?void 0:a.providers)==null?void 0:n.find(r=>!!r.isMetaMask))!=null?o:window.ethereum;if(!t||!t.isMetaMask||!window.ethereum)throw window.open("https://metamask.io/download.html","_blank"),new Error("NO METAMASK WALLET FOUND!");const s=new w(t),e=await t.request({method:"eth_requestAccounts"});return{provider:t,web3:s,accounts:e}},F="YOUR_INFURA_PROJECT_ID",T=async()=>new Promise(async(t,s)=>{const e=new x({infuraId:F}),a=new w(e);let n=!0;const o=()=>n,r=()=>{o()&&s()};e.connector.on("disconnect",r);try{const d=await e.enable();n=!1,t({provider:e,web3:a,accounts:d})}catch{s()}}),j=async t=>{switch(t){case"walletlink":return U();case"metamask":return D();case"walletconnect":return T();default:if(!window.ethereum)throw new Error("NO WALLET FOUND!");return{provider:window.ethereum,web3:new w(window.ethereum),accounts:[]}}},p="web3-provider",h=window.localStorage.getItem(p),B=()=>{const[t,s]=c.exports.useState(),[e,a]=c.exports.useState(),[n,o]=c.exports.useState(),r=c.exports.useCallback(()=>{localStorage.removeItem(p),a(void 0),s(void 0),o(void 0)},[e]),d=c.exports.useCallback(async l=>{try{const{provider:u,web3:b,accounts:v}=await j(l);localStorage.setItem(p,l),a(u),s(b),o(v[0])}catch{console.warn("FAILED TO SIGN IN!"),r()}},[r]);return c.exports.useEffect(()=>{const l=u=>{if(!u.length){r();return}o(u[0])};return e==null||e.on("accountsChanged",l),()=>{e==null||e.removeListener("accountsChanged",l)}},[e,r]),c.exports.useEffect(()=>{if(!(e==null?void 0:e.isWalletConnect))return;const l=()=>{r()};return e==null||e.on("disconnect",l),()=>{e==null||e.removeListener("disconnect",l)}},[e,r]),c.exports.useEffect(()=>{if(!(e==null?void 0:e.isCoinbaseWallet))return;const l=()=>{localStorage.getItem("-walletlink:https://www.walletlink.org:version")||localStorage.removeItem(p)};return addEventListener("beforeunload",l,{capture:!0}),()=>{removeEventListener("beforeunload",l)}},[e]),c.exports.useEffect(()=>{h&&d(h).catch(r)},[]),{connectProvider:d,changeProvider:r,account:n,web3:t}},i=g.exports.jsx,f=g.exports.jsxs,m=c.exports.memo(({providerString:t,handleConnect:s,text:e})=>i("button",{type:"button",onClick:()=>s(t),children:e})),q=c.exports.memo(({handleLogin:t})=>f("div",{className:"content",children:[i("p",{children:"Connect your wallet"}),i(m,{providerString:"walletlink",handleConnect:t,text:"Coinbase Wallet"}),i(m,{providerString:"metamask",handleConnect:t,text:"MetaMask"}),i(m,{providerString:"walletconnect",handleConnect:t,text:"WalletConnect"})]})),J=c.exports.memo(({account:t,web3:s,handleLogout:e})=>f("div",{className:"content",children:[i("p",{children:"Open Sesame!"}),f("small",{children:["Selected account: ",t]}),i("button",{type:"button",onClick:()=>K({web3:s,account:t}),children:"Sign Message"}),i("button",{className:"change-provider",type:"button",onClick:e,children:"Change Provider"})]})),K=async({web3:t,account:s})=>{try{if(!s||!t)throw new Error("NO ACCOUNT AVAILABLE");const e=await t.eth.personal.sign("Open Sesame!",s,"");console.info(e)}catch(e){console.warn(e)}};function Y(){const{connectProvider:t,changeProvider:s,account:e,web3:a}=B(),[n,o]=c.exports.useState(!!h),r=!!e&&!!a;c.exports.useEffect(()=>{r&&n&&o(!1)},[r,n]);const d=c.exports.useCallback(async u=>{o(!0),await t(u).finally(()=>{o(!1)})},[t]),l=c.exports.useCallback(()=>{o(!0),s(),o(!1)},[s]);return f("div",{className:"App",children:[i("h1",{children:"Sesame"}),i("img",{src:r?E:S,className:"App-logo",alt:"logo"}),n?i("p",{children:"loading..."}):f("div",{children:[!r&&i(q,{handleLogin:d}),r&&i(J,{web3:a,account:e,handleLogout:l})]})]})}A.render(i(I.StrictMode,{children:i(Y,{})}),document.getElementById("root"));
