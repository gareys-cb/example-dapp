import{W as E,a as b,j as A,r as a,u as k,R as y,b as N}from"./vendor.532a0028.js";const C=function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&c(n)}).observe(document,{childList:!0,subtree:!0});function e(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerpolicy&&(o.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?o.credentials="include":t.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function c(t){if(t.ep)return;t.ep=!0;const o=e(t);fetch(t.href,o)}};C();var I="./assets/padlock.3a1fe527.png",O="./assets/padlock_open.c4541ffd.png";const x="Sesame",M="http://localhost:3000/src/padlock.png",W="https://mainnet.infura.io/v3/56184607230a477bbe2cb7687f8a7786",P=1,T=()=>new E({appName:x,appLogoUrl:M,darkMode:!1}),U=s=>s.makeWeb3Provider(W,P),S=async s=>{var l,e,c,t;if(!window.ethereum)throw new Error("no eth provider");try{if(s==="walletlink")try{const n=(e=(l=window.ethereum.providers)==null?void 0:l.find(m=>!!m.isCoinbaseWallet))!=null?e:window.ethereum,f=T(),d=U(f),h=new b(d);return!n||!n.isCoinbaseWallet?(console.info("NO COINBASE WALLET FOUND - USING WALLETLINK SDK PROVIDER"),await d.enable(),{ethereum:d,web3:h}):(await n.enable(),{ethereum:n,web3:h})}catch(n){throw window.ethereum.close(),n}if(s==="metamask"){const n=(t=(c=window.ethereum.providers)==null?void 0:c.find(d=>!!d.isMetaMask))!=null?t:window.ethereum;if(!n||!n.isMetaMask)throw new Error("NO METAMASK WALLET FOUND!");await n.request({method:"eth_requestAccounts"});const f=new b(window.ethereum);return{ethereum:n,web3:f}}return{ethereum:window.ethereum,web3:new b(window.ethereum)}}catch(o){throw console.error(o),new Error("Login failed!")}},i=A.exports.jsx,w=A.exports.jsxs,g="web3-provider";function D(){const[s,l]=a.exports.useState(),[e,c]=a.exports.useState(),[t,o]=a.exports.useState(),[n,f]=a.exports.useState(!0),d=!!s;a.exports.useEffect(()=>{const r=u=>{if(console.info("ACCOUNT CHANGED",u[0]),u.length>0){const p=u[0];o(v=>(console.log("prevAccount",v),console.log("newAccount",p),p));return}};return e==null||e.on("accountsChanged",r),()=>{e==null||e.removeListener("accountsChanged",r)}},[e]),a.exports.useEffect(()=>{const r=()=>{(e==null?void 0:e.isCoinbaseWallet)&&!localStorage.getItem("-walletlink:https://www.walletlink.org:version")&&localStorage.removeItem(g)};return addEventListener("beforeunload",r,{capture:!0}),()=>{removeEventListener("beforeunload",r)}}),a.exports.useEffect(()=>{const r=window.localStorage.getItem(g);r&&S(r).then(({ethereum:u,web3:p})=>{c(u),l(p)}).catch(m),f(!1)},[]),a.exports.useEffect(()=>{(e==null?void 0:e.isCoinbaseWallet)&&localStorage.setItem(g,"walletlink"),(e==null?void 0:e.isMetaMask)&&localStorage.setItem(g,"metamask"),s==null||s.eth.getAccounts().then(r=>{o(r[0])})},[s,e]);const h=a.exports.useCallback(async r=>{try{const{ethereum:u,web3:p}=await S(r);c(u),l(p)}catch{console.error("FAILED TO SIGN IN!")}},[]),m=a.exports.useCallback(()=>{localStorage.removeItem(g),c(void 0),l(void 0),(e==null?void 0:e.isCoinbaseWallet)&&(e==null||e.close())},[e]),L=a.exports.useCallback(async()=>{try{if(!t)throw new Error("NO ACCOUNT AVAILABLE");const r=await(s==null?void 0:s.eth.personal.sign("Open Sesame!",t,""));if(!r)throw new Error("YOU MUST BE SIGNED IN TO SIGN A MESSAGE!");console.info(r)}catch(r){console.error(r)}},[s,t]);return i("div",{className:"App",children:w("header",{className:"App-header",children:[i("p",{children:"Sesame"}),i("img",{src:d?O:I,className:"App-logo",alt:"logo"}),n?i("p",{children:"loading..."}):w("div",{children:[!d&&w("div",{children:[w("p",{style:{display:"flex",justifyContent:"space-around"},children:[i("button",{type:"button",onClick:()=>h("walletlink"),children:"Sign in with CB"}),i("button",{type:"button",onClick:()=>h("metamask"),children:"Sign in with MM"})]}),i("p",{children:"Sign in to access your generative password store"})]}),d&&w("div",{children:[i("p",{children:i("button",{type:"button",onClick:m,children:"Sign out"})}),i("p",{children:"Open Sesame! You're logged in"}),i("h6",{children:t})]}),i("button",{type:"button",onClick:L,children:"Sign Message"})]})]})})}window.util=k;y.render(i(N.StrictMode,{children:i(D,{})}),document.getElementById("root"));
